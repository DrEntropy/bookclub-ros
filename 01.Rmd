# Introduction

**Learning objectives:**

- Review key challenges of statistical inference in general.

- Learn key challenges modelling of regression in particular.

## Three Challenges of Statistics

1. Generalizing from sample to population

2. Generalizing from treatment to control group 

3. Generalizing from observed measurements to the underlying constructs of interest 

All three challenges can  be framed as problems of prediction, and in this book we will focus on learning to address this with regression models.

## Why learn regression?

Regression is a method to summarize how predictions or averages of an *outcome* varies across individuals defined by a set of predictors.

Example: US Presidential elections vs economic growth in period leading up to the election:


```{r, echo=FALSE, message=FALSE}
library(rstanarm)
library(tidyverse)
```

```{r}
hibbs <- read_delim('data/hibbs.dat',trim_ws=TRUE, col_types='inncc')

```

```{r, message= FALSE, warning=FALSE, results='hide'}
M1 <- stan_glm(vote ~ growth, data=hibbs)
```

```{r}
ggplot(data=hibbs, aes(x=growth, y=vote)) +
  geom_point() + ylab('Incumbant Vote') + xlab('Precent Growth') +
  geom_abline(intercept = coef(M1)[1], slope = coef(M1)[2], col='blue')
```

We can examine the coefficients by printing the model:

```{r}
print(M1)
```

The median model is $y = 46.3 + 3.0x$ 

## Uses of a regresion model

- *Prediction*: For example, predict future vote (with some uncertainty!) given the economy.

- *Exploring Associations*: For example, the slope above summarizes the impact of the economy on election outcomes.

- *Extrapolation*: For example, pre-election polls can be adjusted for factors like party identification to extrapolate to the voting population at large. (Chapter 17.1)

- *Casual Inference*: Estimating treatment effects. For the election example, we can imagine looking at the effect some law (for example tax cuts) on election outcomes. (Chapter 19)

## Some examples

- *Estimating public opinion from an opt-in internet survey* - Challenge was extrapolation to general public from data collected from Xbox users. (Section 17.1)

- *Randomized experiment on the effect of an educational television program* - Challenge is adjusting for pre-treatment differences between treatment and control. (Section 19.2)

- *Estimating the effects of United Nations peacekeeping*  - Challenges include this being an observational study. A pre-treatment 'badness' score was used to correct for pre-treatment differences.

- *Estimating the effect of gun laws* - The challenge here was the difficulty of inference using regression with a
large number of predictors (50 data points with 30 predictors!!).  Also systematic differences between states were not captured by the models other predictors. 
 
We note that the peacekeeping study and the gun-control study are of the same time, but the peacekeeping study was more focused and was able to approximately account for systematic differences which does not seem possible with the gun-control study.

## Regression for casual inference

* Estimating a relationship:

   - Assumes randomized or balanced groups
   
   - With that, we can estimate directly the causal effect from regression analysis
   
   - Can elaborate the model using non-linear terms and interactions

* Regression to adjust for differences between treatment and control groups

   - Important when there is an *imbalance*
   
   - Good analysis will include clear explanations of any adjustments

## Challenges with building, interpreting and checking models.

- Interpreting coefficients. Example: $\text{earnings}=11000 + 1500*(\text{height}-60) + \text{error}$ where the error has standard deviation $22000$

    - Not good for *forecasting*, the errors are too large.
    
    - Probably not good as *samping inference* without additional predictors help extrapolate from the sample. 
    
    - *Casual inference* is questionalable as short and tall people differ in many ways.
    
    - Good though for *exploring associations*: We observe that there is a positive slope. Might lead to further investigations.
   

- In the 'Build, fit, understand, criticize' cycle:

    - Challenge is to be critical without being nihilistic
    
    - No study is perfect! *Recognize* challenges in extrapolation and *Adjust* for them.

## Model building concerns:

- *Information* - Data, how they were collected, and *prior knowledge*.

- *Assumptions* - The functional form of the regression, statistical models (normal, binomial, etc), ...

- *Interpretation* - Two primary approaches, Classical and Bayesian:

   - *Classical*
   
       - Traditional approach based on summarizing the information in the data
   
       - Estimates should be correct on average (unbiased), and confidence intervals should cover the true parameter value 95% of the time (coverage). (When same statistical procedure is applied to many different problems.)
       
       - Strength is that this approach emphasizes 'objectivity' and not prior information- data 'speaks' for itself.
       
       - Weakness is when studies are small and data are indirect or highly variable
   
   - *Bayesian*
   
       - Incorporates prior information into inferences to go beyond merely summarizing data
       
       - Strength: Can provide valid predictions even with weak data.
       
       - Weakness is the required prior information.  
       
       - Practical advantage: Inferences can be represented by *random simulations*. 
       
    - *No correct answer* - be aware of your options. However we can use Bayesian methods (`stan_glm`) with noninformative or weakly informative priors to obtain results similar to classical methods (and still get simulation draws to express uncertainty!).  

::: {style="color: blue;"}
More on incorporating prior information in the Bayesian approach in chapter 9
:::


## Computing least squares and Bayesian regression

In r, to fit a Bayesian regression you can use `stan_glm` (which assume weakly informative default priors)

```
fit <- stan_glm(y ~ x, data = mydata)
```

If you prefer you can use `lm`:

```
fit <- lm(y ~ x, data = mydata)
```

The results will be very similar.

```{r}
M2 <- lm(vote ~ growth, data=hibbs)
summary(M2)
```
```{r}
summary(M1)
```

Also you can probably follow along in Python with Bambi:

```
model = bmb.Model('y ~ x', mydata)
``
 

## Meeting Videos

### Cohort 1

`r knitr::include_url("https://www.youtube.com/embed/VYivNF3xL9c")`

<!--
### Cohort 2

`r knitr::include_url("https://www.youtube.com/embed/URL")`

<details>
<summary> Meeting chat log </summary>

```
LOG
```
</details>
-->
