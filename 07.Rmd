# Linear regression with a single predictor

**Learning objectives:**

- Introduce regression for a single predictor $y_i = a + b x_i + \text{error}$
- Demonstrate the steps of fitting, plotting and interpreting the fit. 
- Learn to check the procedure using fake-data simulation
- Learn how regression includes simple comparison as a simple case
 
## Example data {-}

```{r, message=FALSE}
library(ggplot2)
library(dplyr)
library(rstanarm)
```

This data comes from:

https://www.kaggle.com/datasets/spittman1248/cdc-data-nutrition-physical-activity-obesity

I will use a small subset, 2016 data containing for each state the percent obese and the percent who engaged in strength training at least twice a week.
```{r}
exercise <- readr::read_csv('data/2016Exercise.csv',show_col_types = FALSE)
head(exercise)
```

```{r, echo=FALSE}
ggplot(exercise, aes(x= strengthTraining, y = obesity)) +  geom_text(aes(label= state))
```

## Fit the data {-}

```{r}
fit = stan_glm(obesity ~ strengthTraining, data = exercise, refresh= 0)
print(fit)
```
What can we learn from this? 

- The fitted line is $y = 61.9 - 1.1 x$  The slope tells us that for every increase in percentage of people in a state that do strength training, we see a corresponding decrease in obesity by about 1.1 percent.

- The uncertainties (MAD_SD) are given for the Intercept and the slope (`strengthTraining`), 3.9 and 0.1 respectively.

- The 95% interval for the slope is about -0.9 to -1.3, well separated from zero.

- The estimated residual standard deviation is 2.5.

```{r, echo=FALSE}
ggplot(exercise) + geom_point( aes(x= strengthTraining, y = obesity))  +
                   geom_abline(aes(slope = coef(fit)[2], intercept = coef(fit)[1]))  + 
                   geom_text( aes(x= strengthTraining, y = obesity, label=state), hjust=1.2, vjust=1, alpha=0.6) +
                   geom_text( x = 24, y = 25, label = glue::glue('obesity = {round(coef(fit)[1],1)} - {-round(coef(fit)[2],1)} strengthTraining '))
```


## Meeting Videos

### Cohort 1

`r knitr::include_url("https://www.youtube.com/embed/hQFkChaqp1w")`

`r knitr::include_url("https://www.youtube.com/embed/wbV4eNkyNVU")`

<!--
### Cohort 2

`r knitr::include_url("https://www.youtube.com/embed/URL")`

<details>
<summary> Meeting chat log </summary>

```
LOG
```
</details>
-->
